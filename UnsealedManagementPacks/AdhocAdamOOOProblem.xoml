<SequentialWorkflowActivity x:Class="WorkflowAuthoring.AdhocAdamOOOProblem" x:Name="AdhocAdamOOOProblem" xmlns:ns0="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.ActivityLibrary;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.ActivityLibrary, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow">
	<ns0:WindowsPowerShellScript x:Name="ProblemOOO" ScriptBody="import-module smlets&#xD;&#xA;$prClass = Get-SCSMClass -name &quot;System.WorkItem.Problem$&quot;&#xD;&#xA;$assignedToRelClass = Get-SCSMRelationshipClass &quot;System.WorkItemAssignedToUser$&quot;&#xD;&#xA;$problem = Get-SCSMObject -class $prClass -filter &quot;Name -eq '$Id'&quot;&#xD;&#xA;$assignedToUserRelationships = Get-SCSMRelationshipObject -BySource $problem -Filter &quot;relationshipid -eq '$($assignedToRelClass.id)'&quot; | Sort-Object LastModified -descending | Select-Object -First 2&#xD;&#xA;$assignedToUsers = $assignedToUserRelationships | foreach-object {Get-SCSMObject -id $_.TargetObject.Id}&#xD;&#xA;if (($assignedToUsers[0].OutOfOffice -eq $true) -and ($assignedToUsers[1]))&#xD;&#xA;{&#xD;&#xA;    #Array of Relationships. New Assigned To is Out of the Office, Assign back to previous&#xD;&#xA;    $assignedToUserRelationships[0] | Remove-SCSMRelationshipObject&#xD;&#xA;    New-SCSMRelationshipObject -Relationship $assignedToRelClass -Source $problem -Target $assignedToUsers[1] -bulk&#xD;&#xA;}&#xD;&#xA;if (($assignedToUsers.OutOfOffice -eq $true) -and ($assignedToUsers.Count -eq 1))&#xD;&#xA;{&#xD;&#xA;    #Single Object. New Assigned To is Out of the Office AND Previous Analyst was never set&#xD;&#xA;    $assignedToUserRelationships | Remove-SCSMRelationshipObject&#xD;&#xA;}" TaskID="AdhocAdamOOOProblem.WindowsPowerShellScript.f2e63a1b_00fc_4f72_af53_2a40688e9e2c" Description="PowerShell script that checks if new Assigned To on Problem is OOO, otherwise reset back to previous state" SnapIns="{x:Null}" ScriptName="{x:Null}" PropertyToBind="{x:Null}" Parameter="{x:Null}">
		<ns0:WindowsPowerShellScript.Parameters>
			<x:Array Type="{x:Type p7:ActivityParameter}" xmlns:p7="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.Common;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.Common, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
				<ns1:ActivityParameter Key="ID" Value="Activity=AdhocAdamOOOProblem, Path=ProblemOOO_ID" BindPath="{ActivityBind AdhocAdamOOOProblem,Path=ProblemOOO_ID}" xmlns:ns1="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.Common;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.Common, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
			</x:Array>
		</ns0:WindowsPowerShellScript.Parameters>
	</ns0:WindowsPowerShellScript>
</SequentialWorkflowActivity>