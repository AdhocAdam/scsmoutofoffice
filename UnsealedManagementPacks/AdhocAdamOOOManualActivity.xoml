<SequentialWorkflowActivity x:Class="WorkflowAuthoring.AdhocAdamOOOManualActivity" x:Name="AdhocAdamOOOManualActivity" xmlns:ns0="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.ActivityLibrary;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.ActivityLibrary, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow">
	<ns0:WindowsPowerShellScript x:Name="ManualActivityOOO" ScriptBody="import-module smlets&#xD;&#xA;$maClass = Get-SCSMClass -name &quot;System.WorkItem.Activity.ManualActivity$&quot;&#xD;&#xA;$assignedToRelClass = Get-SCSMRelationshipClass &quot;System.WorkItemAssignedToUser$&quot;&#xD;&#xA;$manualActivity = Get-SCSMObject -class $maClass -filter &quot;Name -eq '$Id'&quot;&#xD;&#xA;$assignedToUserRelationships = Get-SCSMRelationshipObject -BySource $manualActivity -Filter &quot;relationshipid -eq '$($assignedToRelClass.id)'&quot; | Sort-Object LastModified -descending | Select-Object -First 2&#xD;&#xA;$assignedToUsers = $assignedToUserRelationships | foreach-object {Get-SCSMObject -id $_.TargetObject.Id}&#xD;&#xA;if (($assignedToUsers[0].OutOfOffice -eq $true) -and ($assignedToUsers[1]))&#xD;&#xA;{&#xD;&#xA;    #New Assigned To is Out of the Office, Assign back to previous&#xD;&#xA;    Remove-SCSMRelationshipObject -SMObject $assignedToUserRelationships[0]&#xD;&#xA;    New-SCSMRelationshipObject -Relationship $assignedToRelClass -Source $manualActivity -Target $assignedToUsers[1] -bulk&#xD;&#xA;}&#xD;&#xA;if (($assignedToUsers[0].OutOfOffice -eq $true) -and !($assignedToUsers[1]))&#xD;&#xA;{&#xD;&#xA;    #New Assigned To is Out of the Office AND Previous Analyst was never set&#xD;&#xA;    Remove-SCSMRelationshipObject -SMObject $assignedToUserRelationships[0]&#xD;&#xA;}" TaskID="AdhocAdamOOOManualActivity.WindowsPowerShellScript.b08c0d2b_0803_4a15_8283_c4e7ee69a87f" Description="PowerShell script that checks if new Assigned To on Manual Activity is OOO, otherwise reset back to previous state" SnapIns="{x:Null}" ScriptName="{x:Null}" PropertyToBind="{x:Null}" Parameter="{x:Null}">
		<ns0:WindowsPowerShellScript.Parameters>
			<x:Array Type="{x:Type p7:ActivityParameter}" xmlns:p7="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.Common;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.Common, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
				<ns1:ActivityParameter Key="ID" Value="Activity=AdhocAdamOOOManualActivity, Path=ManualActivityOOO_ID" BindPath="{ActivityBind AdhocAdamOOOManualActivity,Path=ManualActivityOOO_ID}" xmlns:ns1="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.Common;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.Common, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
			</x:Array>
		</ns0:WindowsPowerShellScript.Parameters>
	</ns0:WindowsPowerShellScript>
</SequentialWorkflowActivity>