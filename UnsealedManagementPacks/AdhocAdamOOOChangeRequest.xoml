<SequentialWorkflowActivity x:Class="WorkflowAuthoring.AdhocAdamOOOChangeRequest" x:Name="AdhocAdamOOOChangeRequest" xmlns:ns0="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.ActivityLibrary;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.ActivityLibrary, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow">
	<ns0:WindowsPowerShellScript x:Name="ChangeRequestOOO" ScriptBody="import-module smlets&#xD;&#xA;$crClass = Get-SCSMClass -name &quot;System.WorkItem.ChangeRequest$&quot;&#xD;&#xA;$assignedToRelClass = Get-SCSMRelationshipClass &quot;System.WorkItemAssignedToUser$&quot;&#xD;&#xA;$changeRequest = Get-SCSMObject -class $crClass -filter &quot;Name -eq '$Id'&quot;&#xD;&#xA;$assignedToUserRelationships = Get-SCSMRelationshipObject -BySource $changeRequest -Filter &quot;relationshipid -eq '$($assignedToRelClass.id)'&quot; | Sort-Object LastModified -descending | Select-Object -First 2&#xD;&#xA;$assignedToUsers = $assignedToUserRelationships | foreach-object {Get-SCSMObject -id $_.TargetObject.Id}&#xD;&#xA;if (($assignedToUsers[0].OutOfOffice -eq $true) -and ($assignedToUsers[1]))&#xD;&#xA;{&#xD;&#xA;    #New Assigned To is Out of the Office, Assign back to previous&#xD;&#xA;    Remove-SCSMRelationshipObject -SMObject $assignedToUserRelationships[0]&#xD;&#xA;    New-SCSMRelationshipObject -Relationship $assignedToRelClass -Source $changeRequest -Target $assignedToUsers[1] -bulk&#xD;&#xA;}&#xD;&#xA;if (($assignedToUsers[0].OutOfOffice -eq $true) -and !($assignedToUsers[1]))&#xD;&#xA;{&#xD;&#xA;    #New Assigned To is Out of the Office AND Previous Analyst was never set&#xD;&#xA;    Remove-SCSMRelationshipObject -SMObject $assignedToUserRelationships[0]&#xD;&#xA;}" TaskID="AdhocAdamOOOChangeRequest.WindowsPowerShellScript.a7a82f51_b251_4a83_94c4_54c10a165307" Description="PowerShell script that checks if new Assigned To on Change Request is OOO, otherwise reset back to previous state" SnapIns="{x:Null}" ScriptName="{x:Null}" PropertyToBind="{x:Null}" Parameter="{x:Null}">
		<ns0:WindowsPowerShellScript.Parameters>
			<x:Array Type="{x:Type p7:ActivityParameter}" xmlns:p7="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.Common;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.Common, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
				<ns1:ActivityParameter Key="ID" Value="Activity=AdhocAdamOOOChangeRequest, Path=ChangeRequestOOO_ID" BindPath="{ActivityBind AdhocAdamOOOChangeRequest,Path=ChangeRequestOOO_ID}" xmlns:ns1="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.Common;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.Common, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
			</x:Array>
		</ns0:WindowsPowerShellScript.Parameters>
	</ns0:WindowsPowerShellScript>
</SequentialWorkflowActivity>