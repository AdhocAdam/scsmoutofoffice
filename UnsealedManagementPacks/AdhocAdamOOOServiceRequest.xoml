<SequentialWorkflowActivity x:Class="WorkflowAuthoring.AdhocAdamOOOServiceRequest" x:Name="AdhocAdamOOOServiceRequest" xmlns:ns0="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.ActivityLibrary;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.ActivityLibrary, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow">
	<ns0:WindowsPowerShellScript x:Name="ServiceRequestOOO" ScriptBody="import-module smlets&#xD;&#xA;$srClass = Get-SCSMClass -name &quot;System.WorkItem.ServiceRequest$&quot;&#xD;&#xA;$assignedToRelClass = Get-SCSMRelationshipClass &quot;System.WorkItemAssignedToUser$&quot;&#xD;&#xA;$serviceRequest = Get-SCSMObject -class $srClass -filter &quot;Name -eq '$Id'&quot;&#xD;&#xA;$assignedToUserRelationships = Get-SCSMRelationshipObject -BySource $serviceRequest -Filter &quot;relationshipid -eq '$($assignedToRelClass.id)'&quot; | Sort-Object LastModified -descending | Select-Object -First 2&#xD;&#xA;$assignedToUsers = $assignedToUserRelationships | foreach-object {Get-SCSMObject -id $_.TargetObject.Id}&#xD;&#xA;if (($assignedToUsers[0].OutOfOffice -eq $true) -and ($assignedToUsers[1]))&#xD;&#xA;{&#xD;&#xA;    #New Assigned To is Out of the Office, Assign back to previous&#xD;&#xA;    Remove-SCSMRelationshipObject -SMObject $assignedToUserRelationships[0]&#xD;&#xA;    New-SCSMRelationshipObject -Relationship $assignedToRelClass -Source $serviceRequest -Target $assignedToUsers[1] -bulk&#xD;&#xA;}&#xD;&#xA;if (($assignedToUsers[0].OutOfOffice -eq $true) -and !($assignedToUsers[1]))&#xD;&#xA;{&#xD;&#xA;    #New Assigned To is Out of the Office AND Previous Analyst was never set&#xD;&#xA;    Remove-SCSMRelationshipObject -SMObject $assignedToUserRelationships[0]&#xD;&#xA;}" TaskID="AdhocAdamOOOServiceRequest.WindowsPowerShellScript.37c6b3c2_75b6_484b_8a7d_046565cee6a3" Description="PowerShell script that checks if new Assigned To on Service Request is OOO, otherwise reset back to previous state" SnapIns="{x:Null}" ScriptName="{x:Null}" PropertyToBind="{x:Null}" Parameter="{x:Null}">
		<ns0:WindowsPowerShellScript.Parameters>
			<x:Array Type="{x:Type p7:ActivityParameter}" xmlns:p7="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.Common;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.Common, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
				<ns1:ActivityParameter Key="ID" Value="Activity=AdhocAdamOOOServiceRequest, Path=ServiceRequestOOO_ID" BindPath="{ActivityBind AdhocAdamOOOServiceRequest,Path=ServiceRequestOOO_ID}" xmlns:ns1="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.Common;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.Common, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
			</x:Array>
		</ns0:WindowsPowerShellScript.Parameters>
	</ns0:WindowsPowerShellScript>
</SequentialWorkflowActivity>